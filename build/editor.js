(()=>{var e={609:e=>{"use strict";e.exports=window.React},926:function(e,t,n){!function(e,t){"use strict";function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,a,o=[],_n=!0,i=!1;try{for(n=n.call(e);!(_n=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);_n=!0);}catch(e){i=!0,a=e}finally{try{_n||null==n.return||n.return()}finally{if(i)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u,m,p,d,f={exports:{}};f.exports=function(){if(d)return p;d=1;var e=m?u:(m=1,u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function t(){}function n(){}return n.resetWarningCache=t,p=function(){function r(t,n,r,a,o,i){if(i!==e){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function a(){return r}r.isRequired=r;var o={array:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:a,element:r,elementType:r,instanceOf:a,node:r,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o}}()();var h=l(f.exports),b=function(e,n,r){var a=!!r,o=t.useRef(r);t.useEffect((function(){o.current=r}),[r]),t.useEffect((function(){if(!a||!e)return function(){};var t=function(){o.current&&o.current.apply(o,arguments)};return e.on(n,t),function(){e.off(n,t)}}),[a,n,e,o])},y=function(e){var n=t.useRef(e);return t.useEffect((function(){n.current=e}),[e]),n.current},g=function(e){return null!==e&&"object"===a(e)},v="[object Object]",E=function e(t,n){if(!g(t)||!g(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var a=Object.prototype.toString.call(t)===v;if(a!==(Object.prototype.toString.call(n)===v))return!1;if(!a&&!r)return t===n;var o=Object.keys(t),i=Object.keys(n);if(o.length!==i.length)return!1;for(var c={},s=0;s<o.length;s+=1)c[o[s]]=!0;for(var l=0;l<i.length;l+=1)c[i[l]]=!0;var u=Object.keys(c);if(u.length!==o.length)return!1;var m=t,p=n;return u.every((function(t){return e(m[t],p[t])}))},R=function(e,t,n){return g(e)?Object.keys(e).reduce((function(a,i){var c=!g(t)||!E(e[i],t[i]);return n.includes(i)?(c&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),a):c?r(r({},a||{}),{},o({},i,e[i])):a}),null):null},C="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",w=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C;if(null===e||g(t=e)&&"function"==typeof t.elements&&"function"==typeof t.createToken&&"function"==typeof t.createPaymentMethod&&"function"==typeof t.confirmCardPayment)return e;throw new Error(n)},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C;if(function(e){return g(e)&&"function"==typeof e.then}(e))return{tag:"async",stripePromise:Promise.resolve(e).then((function(e){return w(e,t)}))};var n=w(e,t);return null===n?{tag:"empty"}:{tag:"sync",stripe:n}},N=function(e){e&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"3.6.0"}),e.registerAppInfo({name:"react-stripe-js",version:"3.6.0",url:"https://stripe.com/docs/stripe-js/react"}))},S=t.createContext(null);S.displayName="ElementsContext";var P=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},_=function(e){var n=e.stripe,r=e.options,a=e.children,o=t.useMemo((function(){return k(n)}),[n]),i=c(t.useState((function(){return{stripe:"sync"===o.tag?o.stripe:null,elements:"sync"===o.tag?o.stripe.elements(r):null}})),2),s=i[0],l=i[1];t.useEffect((function(){var e=!0,t=function(e){l((function(t){return t.stripe?t:{stripe:e,elements:e.elements(r)}}))};return"async"!==o.tag||s.stripe?"sync"!==o.tag||s.stripe||t(o.stripe):o.stripePromise.then((function(n){n&&e&&t(n)})),function(){e=!1}}),[o,s,r]);var u=y(n);t.useEffect((function(){null!==u&&u!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")}),[u,n]);var m=y(r);return t.useEffect((function(){if(s.elements){var e=R(r,m,["clientSecret","fonts"]);e&&s.elements.update(e)}}),[r,m,s.elements]),t.useEffect((function(){N(s.stripe)}),[s.stripe]),t.createElement(S.Provider,{value:s},a)};_.propTypes={stripe:h.any,options:h.object};var x=function(e){var n=t.useContext(S);return P(n,e)},j=function(e){return(0,e.children)(x("mounts <ElementsConsumer>"))};j.propTypes={children:h.func.isRequired};var O=["on","session"],T=t.createContext(null);T.displayName="CheckoutSdkContext";var A=function(e,t){if(!e)throw new Error("Could not find CheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CheckoutProvider> provider."));return e},D=t.createContext(null);D.displayName="CheckoutContext";var I=function(e){var n=e.stripe,r=e.options,a=e.children,o=t.useMemo((function(){return k(n,"Invalid prop `stripe` supplied to `CheckoutProvider`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.")}),[n]),s=c(t.useState(null),2),l=s[0],u=s[1],m=c(t.useState((function(){return{stripe:"sync"===o.tag?o.stripe:null,checkoutSdk:null}})),2),p=m[0],d=m[1],f=function(e,t){d((function(n){return n.stripe&&n.checkoutSdk?n:{stripe:e,checkoutSdk:t}}))},h=t.useRef(!1);t.useEffect((function(){var e=!0;return"async"!==o.tag||p.stripe?"sync"===o.tag&&o.stripe&&!h.current&&(h.current=!0,o.stripe.initCheckout(r).then((function(e){e&&(f(o.stripe,e),e.on("change",u))}))):o.stripePromise.then((function(t){t&&e&&!h.current&&(h.current=!0,t.initCheckout(r).then((function(e){e&&(f(t,e),e.on("change",u))})))})),function(){e=!1}}),[o,p,r,u]);var b=y(n);t.useEffect((function(){null!==b&&b!==n&&console.warn("Unsupported prop change on CheckoutProvider: You cannot change the `stripe` prop after setting it.")}),[b,n]);var g=y(r);t.useEffect((function(){var e,t;if(p.checkoutSdk){var n=null==g||null===(e=g.elementsOptions)||void 0===e?void 0:e.appearance,a=null==r||null===(t=r.elementsOptions)||void 0===t?void 0:t.appearance;a&&!E(a,n)&&p.checkoutSdk.changeAppearance(a)}}),[r,g,p.checkoutSdk]),t.useEffect((function(){N(p.stripe)}),[p.stripe]);var v=t.useMemo((function(){return function(e,t){if(!e)return null;e.on,e.session;var n=i(e,O);return t?Object.assign(t,n):Object.assign(e.session(),n)}(p.checkoutSdk,l)}),[p.checkoutSdk,l]);return p.checkoutSdk?t.createElement(T.Provider,{value:p},t.createElement(D.Provider,{value:v},a)):null};I.propTypes={stripe:h.any,options:h.shape({fetchClientSecret:h.func.isRequired,elementsOptions:h.object}).isRequired};var B=function(e){var n=t.useContext(T),r=t.useContext(S);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return n?A(n,e):P(r,e)},$=["mode"],M=function(e,n){var r,a="".concat((r=e).charAt(0).toUpperCase()+r.slice(1),"Element"),o=n?function(e){B("mounts <".concat(a,">"));var n=e.id,r=e.className;return t.createElement("div",{id:n,className:r})}:function(n){var r,o=n.id,s=n.className,l=n.options,u=void 0===l?{}:l,m=n.onBlur,p=n.onFocus,d=n.onReady,f=n.onChange,h=n.onEscape,g=n.onClick,v=n.onLoadError,E=n.onLoaderStart,C=n.onNetworksChange,w=n.onConfirm,k=n.onCancel,N=n.onShippingAddressChange,S=n.onShippingRateChange,P=B("mounts <".concat(a,">")),_="elements"in P?P.elements:null,x="checkoutSdk"in P?P.checkoutSdk:null,j=c(t.useState(null),2),O=j[0],T=j[1],A=t.useRef(null),D=t.useRef(null);b(O,"blur",m),b(O,"focus",p),b(O,"escape",h),b(O,"click",g),b(O,"loaderror",v),b(O,"loaderstart",E),b(O,"networkschange",C),b(O,"confirm",w),b(O,"cancel",k),b(O,"shippingaddresschange",N),b(O,"shippingratechange",S),b(O,"change",f),d&&(r="expressCheckout"===e?d:function(){d(O)}),b(O,"ready",r),t.useLayoutEffect((function(){if(null===A.current&&null!==D.current&&(_||x)){var t=null;if(x)switch(e){case"payment":t=x.createPaymentElement(u);break;case"address":if(!("mode"in u))throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");var n=u.mode,r=i(u,$);if("shipping"===n)t=x.createShippingAddressElement(r);else{if("billing"!==n)throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.");t=x.createBillingAddressElement(r)}break;case"expressCheckout":t=x.createExpressCheckoutElement(u);break;case"currencySelector":t=x.createCurrencySelectorElement();break;default:throw new Error("Invalid Element type ".concat(a,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else _&&(t=_.create(e,u));A.current=t,T(t),t&&t.mount(D.current)}}),[_,x,u]);var I=y(u);return t.useEffect((function(){if(A.current){var e=R(u,I,["paymentRequest"]);e&&"update"in A.current&&A.current.update(e)}}),[u,I]),t.useLayoutEffect((function(){return function(){if(A.current&&"function"==typeof A.current.destroy)try{A.current.destroy(),A.current=null}catch(e){}}}),[]),t.createElement("div",{id:o,className:s,ref:D})};return o.propTypes={id:h.string,className:h.string,onChange:h.func,onBlur:h.func,onFocus:h.func,onReady:h.func,onEscape:h.func,onClick:h.func,onLoadError:h.func,onLoaderStart:h.func,onNetworksChange:h.func,onConfirm:h.func,onCancel:h.func,onShippingAddressChange:h.func,onShippingRateChange:h.func,options:h.object},o.displayName=a,o.__elementType=e,o},F="undefined"==typeof window,L=t.createContext(null);L.displayName="EmbeddedCheckoutProviderContext";var U=function(){var e=t.useContext(L);if(!e)throw new Error("<EmbeddedCheckout> must be used within <EmbeddedCheckoutProvider>");return e},Y=F?function(e){var n=e.id,r=e.className;return U(),t.createElement("div",{id:n,className:r})}:function(e){var n=e.id,r=e.className,a=U().embeddedCheckout,o=t.useRef(!1),i=t.useRef(null);return t.useLayoutEffect((function(){return!o.current&&a&&null!==i.current&&(a.mount(i.current),o.current=!0),function(){if(o.current&&a)try{a.unmount(),o.current=!1}catch(e){}}}),[a]),t.createElement("div",{ref:i,id:n,className:r})},q=M("auBankAccount",F),W=M("card",F),H=M("cardNumber",F),G=M("cardExpiry",F),z=M("cardCvc",F),J=M("fpxBank",F),V=M("iban",F),K=M("idealBank",F),Q=M("p24Bank",F),X=M("epsBank",F),Z=M("payment",F),ee=M("expressCheckout",F),te=M("currencySelector",F),ne=M("paymentRequestButton",F),re=M("linkAuthentication",F),ae=M("address",F),oe=M("shippingAddress",F),ie=M("paymentMethodMessaging",F),ce=M("affirmMessage",F),se=M("afterpayClearpayMessage",F);e.AddressElement=ae,e.AffirmMessageElement=ce,e.AfterpayClearpayMessageElement=se,e.AuBankAccountElement=q,e.CardCvcElement=z,e.CardElement=W,e.CardExpiryElement=G,e.CardNumberElement=H,e.CheckoutProvider=I,e.CurrencySelectorElement=te,e.Elements=_,e.ElementsConsumer=j,e.EmbeddedCheckout=Y,e.EmbeddedCheckoutProvider=function(e){var n=e.stripe,r=e.options,a=e.children,o=t.useMemo((function(){return k(n,"Invalid prop `stripe` supplied to `EmbeddedCheckoutProvider`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.")}),[n]),i=t.useRef(null),s=t.useRef(null),l=c(t.useState({embeddedCheckout:null}),2),u=l[0],m=l[1];t.useEffect((function(){if(!s.current&&!i.current){var e=function(e){s.current||i.current||(s.current=e,i.current=s.current.initEmbeddedCheckout(r).then((function(e){m({embeddedCheckout:e})})))};"async"!==o.tag||s.current||!r.clientSecret&&!r.fetchClientSecret?"sync"!==o.tag||s.current||!r.clientSecret&&!r.fetchClientSecret||e(o.stripe):o.stripePromise.then((function(t){t&&e(t)}))}}),[o,r,u,s]),t.useEffect((function(){return function(){u.embeddedCheckout?(i.current=null,u.embeddedCheckout.destroy()):i.current&&i.current.then((function(){i.current=null,u.embeddedCheckout&&u.embeddedCheckout.destroy()}))}}),[u.embeddedCheckout]),t.useEffect((function(){N(s)}),[s]);var p=y(n);t.useEffect((function(){null!==p&&p!==n&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the `stripe` prop after setting it.")}),[p,n]);var d=y(r);return t.useEffect((function(){null!=d&&(null!=r?(void 0===r.clientSecret&&void 0===r.fetchClientSecret&&console.warn("Invalid props passed to EmbeddedCheckoutProvider: You must provide one of either `options.fetchClientSecret` or `options.clientSecret`."),null!=d.clientSecret&&r.clientSecret!==d.clientSecret&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the client secret after setting it. Unmount and create a new instance of EmbeddedCheckoutProvider instead."),null!=d.fetchClientSecret&&r.fetchClientSecret!==d.fetchClientSecret&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change fetchClientSecret after setting it. Unmount and create a new instance of EmbeddedCheckoutProvider instead."),null!=d.onComplete&&r.onComplete!==d.onComplete&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onComplete option after setting it."),null!=d.onShippingDetailsChange&&r.onShippingDetailsChange!==d.onShippingDetailsChange&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onShippingDetailsChange option after setting it."),null!=d.onLineItemsChange&&r.onLineItemsChange!==d.onLineItemsChange&&console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot change the onLineItemsChange option after setting it.")):console.warn("Unsupported prop change on EmbeddedCheckoutProvider: You cannot unset options after setting them."))}),[d,r]),t.createElement(L.Provider,{value:u},a)},e.EpsBankElement=X,e.ExpressCheckoutElement=ee,e.FpxBankElement=J,e.IbanElement=V,e.IdealBankElement=K,e.LinkAuthenticationElement=re,e.P24BankElement=Q,e.PaymentElement=Z,e.PaymentMethodMessagingElement=ie,e.PaymentRequestButtonElement=ne,e.ShippingAddressElement=oe,e.useCheckout=function(){!function(e){var n=t.useContext(T);A(n,e)}("calls useCheckout()");var e=t.useContext(D);if(!e)throw new Error("Could not find Checkout Context; You need to wrap the part of your app that calls useCheckout() in an <CheckoutProvider> provider.");return e},e.useElements=function(){return x("calls useElements()").elements},e.useStripe=function(){return B("calls useStripe()").stripe}}(t,n(609))}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(()=>{"use strict";var e,t=n(609),r="https://js.stripe.com",a="".concat(r,"/v3"),o=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,i=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,c="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",s=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(a).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n},l=null,u=null,m=null,p=!1,d=function(){return e||(e=(t=null,null!==l?l:(l=new Promise((function(e,n){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&t&&console.warn(c),window.Stripe)e(window.Stripe);else try{var a=function(){for(var e,t=document.querySelectorAll('script[src^="'.concat(r,'"]')),n=0;n<t.length;n++){var a=t[n];if(e=a.src,o.test(e)||i.test(e))return a}return null}();if(a&&t)console.warn(c);else if(a){if(a&&null!==m&&null!==u){var l;a.removeEventListener("load",m),a.removeEventListener("error",u),null===(l=a.parentNode)||void 0===l||l.removeChild(a),a=s(t)}}else a=s(t);m=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(e,n),u=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}}(n),a.addEventListener("load",m),a.addEventListener("error",u)}catch(e){return void n(e)}else e(null)}))).catch((function(e){return l=null,Promise.reject(e)}))).catch((function(t){return e=null,Promise.reject(t)})));var t};Promise.resolve().then((function(){return d()})).catch((function(e){p||console.warn(e)}));var f=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];p=!0;var r=Date.now();return d().then((function(e){return function(e,t,n){if(null===e)return null;var r=t[0].match(/^pk_test/),a=function(e){return 3===e?"v3":e}(e.version);r&&"v3"!==a&&console.warn("Stripe.js@".concat(a," was loaded on the page, but @stripe/stripe-js@").concat("5.10.0"," expected Stripe.js@").concat("v3",". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var o=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"5.10.0",startTime:t})}(o,n),o}(e,t,r)}))},h=n(926);const b=function(){const e=document.querySelector('link[rel="https://api.w.org/"]');return e?e.href.replace(/\/$/,""):(window.wpApiSettings?.restUrl||"/wp-json").replace(/\/$/,"")}(),y=(f("your-publishable-key-here"),e=>new URLSearchParams(window.location.search).get(e)),g=({property:e,isSelected:t,onToggle:n,nights:r,checkInDate:a})=>{const o=e.availability?.total_cost||e.availability?.dates?.reduce(((e,t)=>e+(t.rate||0)),0)||0,i=e.availability?.available,c=(e,t,n)=>{if(e)return"Available";switch(t){case"Booked Out":return"Booked Out";case"No Tariff Set":return"No Rates Set";case"Min Nights":return`Minimum ${n||2} Nights`;default:return"Unavailable"}};return React.createElement("div",{className:`bif-property-card ${t?"bif-selected":""} ${i?"":"bif-unavailable"}`},React.createElement("div",{className:"bif-property-header"},e.image_url&&React.createElement("div",{className:"bif-property-image"},React.createElement("img",{src:e.image_url,alt:e.property_name})),React.createElement("div",{className:"bif-property-info"},React.createElement("h3",{className:"bif-property-name"},e.property_name),e.property_description&&React.createElement("p",{className:"bif-property-description"},e.property_description)),React.createElement("div",{className:"bif-property-status-container"},React.createElement("span",{className:`bif-property-status ${((e,t)=>{if(e)return"bif-status-available";switch(t){case"Booked Out":return"bif-status-booked";case"No Tariff Set":return"bif-status-no-rate";case"Min Nights":return"bif-status-min-nights";default:return"bif-status-unavailable"}})(i,e.availability?.availability_reason)}`},c(i,e.availability?.availability_reason,e.availability?.min_nights)))),e.availability?.dates&&React.createElement("div",{className:"bif-availability-details"},React.createElement("h4",{className:"bif-daily-breakdown-title"},"Daily Rate Breakdown"),React.createElement("div",{className:"bif-daily-rates"},e.availability.dates.map(((e,t)=>React.createElement("div",{key:t,className:"bif-daily-rate "+(e.availability?"bif-available":"bif-unavailable")},React.createElement("div",{className:"bif-date"},e.date_formatted),React.createElement("div",{className:"bif-rate"},e.availability?`$${e.rate}`:"Booked Out"===e.availability_reason?"Booked":"No Tariff Set"===e.availability_reason?"No Rate":"N/A"))))),React.createElement("div",{className:"bif-rate-summary"},React.createElement("div",{className:"bif-summary-row"},React.createElement("span",null,r," ",1===r?"night":"nights"),React.createElement("span",{className:"bif-total"},"Total: $",o)))),React.createElement("div",{className:"bif-property-actions"},i?React.createElement("button",{onClick:n,className:"bif-btn "+(t?"bif-btn-selected":"bif-btn-select")},t?"âœ“ Selected":"Select Property"):React.createElement("button",{disabled:!0,className:"bif-btn bif-btn-disabled"},c(i,e.availability?.availability_reason,e.availability?.min_nights))),t&&e.optional_extras?.length>0&&React.createElement("div",{className:"bif-optional-extras"},React.createElement("h4",{className:"bif-daily-breakdown-title"},"Optional Extras"),React.createElement("div",{className:"bif-extras-list"},e.optional_extras.map((t=>React.createElement("div",{key:t.id,className:"bif-extra-item"},React.createElement("div",{className:"bif-extra-info"},React.createElement("input",{type:"checkbox",checked:e.selectedExtras?.[t.id]||!1,onChange:()=>e.onToggleExtra?.(e.id,t.id)}),React.createElement("label",null,t.description)),React.createElement("div",{className:"bif-extra-price"},"$",t.amount)))))))},v=({checkInDate:e,nights:t,onDateChange:n,onNightsChange:r,onCheckAvailability:a,isLoading:o})=>{const i=(new Date).toISOString().split("T")[0];return React.createElement("div",{className:"bif-date-selector"},React.createElement("h2",{className:"bif-section-title"},"Select Your Dates"),React.createElement("div",{className:"bif-date-form"},React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Check-in Date"),React.createElement("input",{type:"date",value:e,onChange:e=>n(e.target.value),min:i,className:"bif-date-input"})),React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Number of Nights"),React.createElement("select",{value:t,onChange:e=>r(parseInt(e.target.value)),className:"bif-nights-select"},[...Array(14).keys()].map((e=>React.createElement("option",{key:e,value:e+1},e+1," ",e+1===1?"night":"nights"))))),React.createElement("div",{className:"bif-form-field"},React.createElement("button",{onClick:a,disabled:!e||o,className:"bif-btn bif-btn-primary bif-check-availability"},o?React.createElement(React.Fragment,null,React.createElement("div",{className:"bif-spinner"}),React.createElement("span",null,"Checking...")):React.createElement("span",null,"Check Availability")))))},E=({selectedProperties:e,selectedExtras:n,nights:r,total:a,discountCode:o,onDiscountCodeChange:i,onApplyDiscount:c,checkInDate:s,summary:l})=>{const[u,m]=(0,t.useState)(!1);return Object.values(n).flat().reduce(((e,t)=>e+(t.amount||0)),0),e&&0!==e.length?React.createElement("div",{className:"bif-booking-summary"},React.createElement("h3",{className:"bif-section-title"},"Booking Summary"),React.createElement("div",{className:"bif-summary-content"},e.map((e=>{const t=e.availability?.total_cost||e.availability?.dates?.reduce(((e,t)=>e+(t.rate||0)),0)||0,r=e.mandatory_extras?.reduce(((e,t)=>e+parseFloat(t.amount||0)),0)||0,a=parseFloat(t)+parseFloat(r);return React.createElement("div",{key:e.id,className:"bif-property-summary"},React.createElement("h5",{className:"bif-property-summary-name"},e.property_name),React.createElement("div",{className:"bif-property-total"},React.createElement("div",{className:"bif-total-row"},React.createElement("span",null,"Property Subtotal"),React.createElement("span",null,"$",t))),e.mandatory_extras&&e.mandatory_extras.length>0&&React.createElement("div",{className:"bif-mandatory-extras-summary"},React.createElement("h4",{className:"bif-daily-breakdown-title"},"Mandatory Extras"),e.mandatory_extras.map((e=>React.createElement("div",{key:e.id,className:"bif-total-row",style:{fontSize:"0.875rem",color:"#dc2626"}},React.createElement("span",null,e.description),React.createElement("span",null,"$",e.amount))))),React.createElement("div",{className:"bif-property-total"},React.createElement("div",{className:"bif-total-row bif-subtotal"},React.createElement("span",null,"Property Total"),React.createElement("span",null,"$",a))),n[e.id]&&n[e.id].length>0&&React.createElement("div",{className:"bif-optional-extras-summary"},React.createElement("h4",{className:"bif-daily-breakdown-title"},"Selected Optional Extras"),n[e.id].map((e=>React.createElement("div",{key:e.id,className:"bif-total-row",style:{fontSize:"0.875rem",color:"#92400e"}},React.createElement("span",null,e.description),React.createElement("span",null,"$",e.amount))))))})),React.createElement("div",{className:"bif-summary-section"},React.createElement("div",{className:"bif-discount-form"},React.createElement("input",{type:"text",placeholder:"Enter discount code",value:o,onChange:e=>i(e.target.value),className:"bif-discount-input"}),React.createElement("button",{onClick:()=>{o.trim()&&(c(o),m(!0))},className:"bif-btn bif-btn-secondary"},"Apply")),u&&React.createElement("div",{className:"bif-discount-applied"},"Discount code applied")),React.createElement("div",{className:"bif-grand-total"},React.createElement("div",{className:"bif-total-main"},React.createElement("span",null,"Total Cost"),React.createElement("span",{className:"bif-total-amount"},"$",a)),l&&l.order_discount_amount>0&&React.createElement("div",{className:"bif-total-breakdown"},React.createElement("div",{className:"bif-breakdown-row"},React.createElement("span",null,"Discount Applied"),React.createElement("span",null,"-$",l.order_discount_amount)))))):null},R=({userDetails:e,onUpdateDetails:t,formErrors:n})=>React.createElement("div",{className:"bif-customer-details"},React.createElement("h2",{className:"bif-section-title"},"Your Details"),React.createElement("div",{className:"bif-customer-form"},React.createElement("div",{className:"bif-form-row"},React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"First Name *"),React.createElement("input",{type:"text",value:e.firstName,onChange:e=>t("firstName",e.target.value),placeholder:"Enter your first name",className:n.firstName?"bif-error":""}),n.firstName&&React.createElement("div",{className:"bif-field-error"},n.firstName)),React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Last Name *"),React.createElement("input",{type:"text",value:e.lastName,onChange:e=>t("lastName",e.target.value),placeholder:"Enter your last name",className:n.lastName?"bif-error":""}),n.lastName&&React.createElement("div",{className:"bif-field-error"},n.lastName))),React.createElement("div",{className:"bif-form-row"},React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Email *"),React.createElement("input",{type:"email",value:e.email,onChange:e=>t("email",e.target.value),placeholder:"Enter your email address",className:n.email?"bif-error":""}),n.email&&React.createElement("div",{className:"bif-field-error"},n.email)),React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Phone *"),React.createElement("input",{type:"tel",value:e.phone,onChange:e=>t("phone",e.target.value),placeholder:"Enter your phone number",className:n.phone?"bif-error":""}),n.phone&&React.createElement("div",{className:"bif-field-error"},n.phone))),React.createElement("div",{className:"bif-form-row"},React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Postcode"),React.createElement("input",{type:"text",value:e.postcode,onChange:e=>t("postcode",e.target.value),placeholder:"Enter your postcode"})),React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Suburb"),React.createElement("input",{type:"text",value:e.suburb,onChange:e=>t("suburb",e.target.value),placeholder:"Enter your suburb"}))),React.createElement("div",{className:"bif-form-row bif-full-width"},React.createElement("div",{className:"bif-form-field"},React.createElement("label",null,"Comments"),React.createElement("textarea",{value:e.comments,onChange:e=>t("comments",e.target.value),rows:4,placeholder:"Any special requests or comments..."}))))),C=({summary:e,propertyIds:n,userDetails:r,paymentType:a,giftCertificate:o})=>{const i=(0,h.useStripe)(),c=(0,h.useElements)(),[s,l]=(0,t.useState)(!1),[u,m]=(0,t.useState)(""),[p,d]=(0,t.useState)(!1),[f,y]=(0,t.useState)("");return React.createElement("div",{className:"bif-payment-container"},React.createElement("h3",null,"ðŸ’³ Payment Details"),u&&React.createElement("div",{className:"bif-error-message"},u),p?React.createElement("div",{className:"bif-success-message"},React.createElement("p",null,React.createElement("strong",null,"âœ… Payment Successful!")),f&&React.createElement("p",null,React.createElement("a",{href:f,target:"_blank",rel:"noopener noreferrer"},"ðŸ“„ Click here to view your receipt"))):React.createElement("form",{onSubmit:async t=>{if(t.preventDefault(),!i||!c)return void console.error("Stripe.js has not loaded yet.");l(!0),m("");const s=c.getElement(h.CardElement);try{const{paymentMethod:t,error:c}=await i.createPaymentMethod({type:"card",card:s});if(c)return console.error(c),m(c.message),void l(!1);const u="deposit"===a?e.order_deposit_amount:e.order_payable_now,p={stripePaymentMethodId:t.id,amount:u,currency:"AUD",summary:e,propertyIds:"string"==typeof n?n.split(",").map((e=>parseInt(e.trim()))):n,userDetails:r,paymentType:a};"gift"===a&&o&&(p.giftCertificateApplied=!0,p.giftCertificate=o);const f=await fetch(`${b}/bookitfast/v1/process-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}),h=await f.json();if(!h.success)throw new Error(h.message||"Payment failed.");console.log("Payment successful:",h),y(h.data.charge),d(!0)}catch(e){console.error("Payment error:",e),m(e.message)}finally{l(!1)}},className:"bif-stripe-form"},React.createElement("div",{className:"bif-card-element-container"},React.createElement(h.CardElement,{options:{hidePostalCode:!0,style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})),React.createElement("button",{type:"submit",disabled:!i||s,className:"bif-btn bif-btn-primary bif-btn-large"},s?"Processing...":"Pay Now")))},w=({propertyIds:e="",showDiscount:n=!1,showSuburb:r=!0,showPostcode:a=!0,showRedeemGiftCertificate:o=!1,showComments:i=!1})=>{const c=y("nights"),s=c&&!isNaN(c)?parseInt(c,10):1,l=y("start"),u=y("discount"),m=l?(e=>{const t=e.split("-");if(3===t.length){const[e,n,r]=t.map(Number);if(!isNaN(e)&&!isNaN(n)&&!isNaN(r)){const t=new Date(r,n-1,e);return t.setHours(12,0,0,0),t.toISOString().split("T")[0]}}return null})(l):"",p="string"==typeof e?e:"",[d,w]=(0,t.useState)({date:m,nights:s}),[k,N]=(0,t.useState)(null),[S,P]=(0,t.useState)({}),[_,x]=(0,t.useState)(null),[j,O]=(0,t.useState)(null),[T,A]=(0,t.useState)(!1),[D,I]=(0,t.useState)(""),[B,$]=(0,t.useState)({firstName:"",lastName:"",phone:"",email:"",postcode:"",suburb:"",comments:""}),[M,F]=(0,t.useState)(!1),[L,U]=(0,t.useState)(u),[Y,q]=(0,t.useState)(null),[W,H]=(0,t.useState)(!1),[G,z]=(0,t.useState)(null),[J,V]=(0,t.useState)({}),[K,Q]=(0,t.useState)({number:"",pin:""}),[X,Z]=(0,t.useState)(!1),[ee,te]=(0,t.useState)(null),[ne,re]=(0,t.useState)({}),[ae,oe]=(0,t.useState)(!1);(0,t.useEffect)((()=>{m&&s&&(console.log("Auto-checking availability with:",m,s),ie(m,s))}),[m,s]);const ie=async(e=d.date,t=d.nights)=>{if(!e||!p)return void console.warn("fetchAvailability skipped - Missing startDate or propertyIds");const n=d.date,r=p.split(",").filter((e=>""!==e.trim()));console.log("Requesting availability with:",{ids:r,start:n,nights:t}),A(!0),I(""),oe(!1);try{const e=await fetch(`${b}/bookitfast/v1/availability`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:r,start:n,nights:t})}),a=await e.json();N(a),oe(!0);const o=Object.keys(a).reduce(((e,t)=>(e[t]=!1,e)),{});P(o)}catch(e){console.error(e),I("Failed to fetch availability. Please try again.")}finally{A(!1)}},ce=(e,t)=>{re((n=>{const r=n[e]||{},a={...n,[e]:{...r,[t]:!r[t]}};return se(S,L,a,0),a}))},se=async(e,t=null,n=ne,r=0)=>{const a=d.date,o=d.nights,i=new Date(new Date(a).getTime()+864e5*o).toISOString().split("T")[0];A(!0),I("");try{const r=await fetch(`${b}/bookitfast/v1/availability/summary`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({selected:e,selected_optional_extras:n,start:a,end:i,discount_code:t||null})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const o=await r.json();O(o),o.stripe_publishable_key&&x(f(o.stripe_publishable_key))}catch(a){console.error("Error fetching summary:",a),r<3?(console.log(`Retrying... Attempt ${r+1}`),await se(e,t,n,r+1)):I("Failed to fetch summary. Please try again.")}finally{A(!1)}},le=e=>{(()=>{const e={};return B.firstName.trim()||(e.firstName="First name is required"),B.lastName.trim()||(e.lastName="Last name is required"),B.email.trim()||(e.email="Email is required"),B.phone.trim()||(e.phone="Phone is required"),M||(e.agreeToTerms="You must agree to the terms and conditions"),V(e),0===Object.keys(e).length})()&&(z(e),H(!0))},ue=k?Object.entries(k).filter((([e])=>S[e])).map((([e,t])=>({id:e,...t,selectedExtras:ne[e],onToggleExtra:ce}))):[];return React.createElement("div",{className:"bif-booking-container"},React.createElement("div",{className:"bif-booking-steps"},React.createElement(v,{checkInDate:d.date,nights:d.nights,onDateChange:e=>w((t=>({...t,date:e}))),onNightsChange:e=>w((t=>({...t,nights:e}))),onCheckAvailability:ie,isLoading:T}),D&&React.createElement("div",{className:"bif-error-message"},D),ae&&k&&React.createElement("div",{className:"bif-property-list"},React.createElement("h2",{className:"bif-section-title"},"Available Properties"),React.createElement("div",{className:"bif-properties"},Object.entries(k).map((([e,t])=>React.createElement(g,{key:e,property:{id:e,...t,selectedExtras:ne[e],onToggleExtra:ce},isSelected:S[e],onToggle:()=>(async e=>{const t={...S,[e]:!S[e]};P(t),Object.values(t).includes(!0)?await se(t,L):O(null)})(e),nights:d.nights,checkInDate:d.date}))))),j&&ue.length>0&&React.createElement(E,{selectedProperties:ue,selectedExtras:ne,nights:d.nights,total:j.order_payable_now||0,discountCode:L,onDiscountCodeChange:U,onApplyDiscount:e=>{Object.keys(S).some((e=>S[e]))&&se(S,e)},checkInDate:d.date,summary:j}),j&&ue.length>0&&React.createElement(R,{userDetails:B,onUpdateDetails:(e,t)=>{$((n=>({...n,[e]:t}))),J[e]&&V((t=>({...t,[e]:null})))},formErrors:J}),j&&ue.length>0&&React.createElement("div",{className:"bif-terms-payment"},React.createElement("div",{className:"bif-terms-checkbox"},React.createElement("input",{type:"checkbox",id:"agreeToTerms",checked:M,onChange:()=>F(!M)}),React.createElement("label",{htmlFor:"agreeToTerms"},"I have read and agree to the"," ",j.order_booking_conditions?.map(((e,t)=>React.createElement("span",{key:t},React.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.title),t<j.order_booking_conditions.length-2?", ":"",t===j.order_booking_conditions.length-2?" and ":"")))),J.agreeToTerms&&React.createElement("div",{className:"bif-field-error"},J.agreeToTerms)),!W&&React.createElement("div",{className:"bif-payment-options"},Object.keys(J).length>0&&React.createElement("div",{className:"bif-validation-error"},"Please complete all required fields before proceeding with payment."),j.order_deposit_amount>0?React.createElement("div",{className:"bif-payment-buttons"},React.createElement("button",{className:"bif-btn bif-btn-primary",onClick:()=>le("deposit")},"ðŸ’³ Pay Deposit ($",j.order_deposit_amount,")"),React.createElement("button",{className:"bif-btn bif-btn-primary",onClick:()=>le("full")},"ðŸ’³ Pay In Full ($",j.order_payable_now,")")):React.createElement("button",{className:"bif-btn bif-btn-primary bif-btn-large",onClick:()=>le("full")},"ðŸ’³ Complete Booking - $",j.order_payable_now),j.order_surcharge>0&&React.createElement("div",{className:"bif-surcharge-info"},React.createElement("p",null,"Please note a credit card surcharge applies of",j.order_deposit_surcharge>0&&` $${j.order_deposit_surcharge} for deposit or `,"$",j.order_surcharge," for the full payment.")))),_&&j&&W&&React.createElement("div",{className:"bif-payment-form-container"},React.createElement(h.Elements,{stripe:_},React.createElement(C,{summary:j,propertyIds:p.split(",").map((e=>parseInt(e.trim()))),userDetails:B,paymentType:G,giftCertificate:"gift"===G?ee:null})))))},k=window.wp.blocks,N=window.wp.blockEditor,S=window.wp.components,{useState:P,useEffect:_}=wp.element;(0,k.registerBlockType)("bookitfast/multi-embed",{title:"Book It Fast Availability",description:"A multi-property booking embed for WordPress.",icon:"calendar",category:"widgets",attributes:{propertyIds:{type:"string",default:""},showDiscount:{type:"boolean",default:!1},showSuburb:{type:"boolean",default:!1},showPostcode:{type:"boolean",default:!1},showRedeemGiftCertificate:{type:"boolean",default:!1},showComments:{type:"boolean",default:!1}},edit:({attributes:e,setAttributes:t})=>{const n=(0,N.useBlockProps)(),[r,a]=P([]),[o,i]=P(!0),[c,s]=P(null);return _((()=>{wp.apiFetch({path:"/bookitfast/v1/properties"}).then((e=>{e.success?a(e.properties):s("Failed to fetch properties.")})).catch((e=>{console.error("API Fetch Error:",e),s("Error fetching properties.")})).finally((()=>i(!1)))}),[]),React.createElement("div",n,React.createElement(N.InspectorControls,null,React.createElement(S.PanelBody,{title:"Settings",initialOpen:!0},o?React.createElement("p",null,"Loading properties..."):c?React.createElement("p",{style:{color:"red"}},c):React.createElement(S.SelectControl,{multiple:!0,label:"Select Properties",value:e.propertyIds?e.propertyIds.split(","):[],options:r.map((e=>({label:e.title,value:e.id.toString()}))),onChange:e=>{const n=e.join(",");t({propertyIds:n})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),React.createElement(S.ToggleControl,{label:"Show Discount Field",checked:e.showDiscount,onChange:e=>t({showDiscount:e}),__nextHasNoMarginBottom:!0}),React.createElement(S.ToggleControl,{label:"Show Suburb Field",checked:e.showSuburb,onChange:e=>t({showSuburb:e}),__nextHasNoMarginBottom:!0}),React.createElement(S.ToggleControl,{label:"Show Postcode Field",checked:e.showPostcode,onChange:e=>t({showPostcode:e}),__nextHasNoMarginBottom:!0}),React.createElement(S.ToggleControl,{label:"Show Redeem Gift Certificate Section",checked:e.showRedeemGiftCertificate,onChange:e=>t({showRedeemGiftCertificate:e}),__nextHasNoMarginBottom:!0}),React.createElement(S.ToggleControl,{label:"Show Comments Field",checked:e.showComments,onChange:e=>t({showComments:e}),__nextHasNoMarginBottom:!0}))),React.createElement(w,{propertyIds:e.propertyIds,showDiscount:e.showDiscount,showSuburb:e.showSuburb,showPostcode:e.showPostcode,showRedeemGiftCertificate:e.showRedeemGiftCertificate,showComments:e.showComments}))},save:()=>null})})()})();